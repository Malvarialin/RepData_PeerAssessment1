---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
    
   
---

## Loading and preprocessing the data
First things first. The data is available [here](http://github.com/rdpeng/RepData_PeerAssessment1). The following R code from this point on assumes that the data is in your working directory. Unzip and load the csv file into R.
```{r,echo=TRUE}
unzip('activity.zip')
data <- read.csv('activity.csv')
```
Now it's time to reformat the date column.
```{r,echo=TRUE}
data$date <- as.Date(data$date)
```

## What is mean total number of steps taken per day?
The easiest way to do this is to load up the dplyr package and use the group_by and summarize commands to get the sum of steps for each day, which can then be averaged.


```{r,echo=TRUE,results="hide",messages=FALSE,warning=FALSE}
library(dplyr)
```

1. Calculate the total number of steps taken per day.

I used dplyr's summarize function to group and add the steps by day.
```{r,echo=TRUE}
by_date <- group_by(data,date)
sums <- summarize(by_date,stepsum=sum(steps))
```


2. Make a histogram of the total number of steps taken each day.
```{r,echo=TRUE}
hist(sums$stepsum, main= 'Histogram of Daily Steps',xlab='Steps taken per day')
```

3. Finally, the mean number of steps taken per day.

```{r,echo=TRUE}
mean(sums$stepsum,na.rm=TRUE)
```

And the median.
```{r,echo-TRUE}
median(sums$stepsum, na.rm=TRUE)
```
## What is the average daily activity pattern?
1. Make a time series plot of the 5-minute interval and the average number of steps taken, averaged accross all days.

Same idea. Though this time plot the means rather than the sums (also barplot, not histogram).
```{r,echo=TRUE}
by_interval <- group_by(data,interval)

means <- summarize(by_interval,average=mean(steps,na.rm=TRUE))

plot(means$interval,means$average,type='l',xlab='Interval',ylab='Average steps',main='Interval vs. Average steps')
```

2. Which interval, on average across all the days in the dataset, contains the maximum number of steps?

I used the max function and had it search for the corresponding interval.

```{r,echo=TRUE}
means$interval[which(means$average==max(means$average))]
```
Interval 835.

## Imputing missing values

1. Calculate and report the total number of missing values in the dataset.

```{r,echo=TRUE}
sum(!complete.cases(data))
```

2. & 3. Devise a strategy for filling in all of the missing values in the dataset and create a new set with missing data filled in.

For the purposes of this assignment, I'm going to use the average number of steps taken per interval for our replacement value.

```{r,echo=TRUE}
data[is.na(data)] <- mean(data$steps,na.rm=TRUE)
```

4. Make a histogram of the total number of steps taken each day.


```{r,echo=TRUE}
by_date <- group_by(data,date)
sums <- summarize(by_date,stepsum=sum(steps))
hist(sums$stepsum, main= 'Histogram of Daily Steps',xlab='Steps taken per day')
```

The new mean.
```{r,echo=TRUE}
mean(sums$stepsum,na.rm=TRUE)
```
And the new median.
```{r,echo=TRUE}
median(sums$stepsum, na.rm=TRUE)
```

So we can see that using this method did not change the mean, however it did slighty change our median (which is now equal to our mean).  Replacing the missing values largely just made our histogram taller (though it retained its basic distribution/shape).

## Are there differences in activity patterns between weekdays and weekends?


1. Create a new factor variable in the dataset with two levels--'weekday' and 'weekend' indicating whether a given days is a weeday or weekend day.

I'm going to create a true/false variable indicating whether or not a given variable is a weekend day or not (using libridate's wday function to make dates easier to work with).

```{r,echo=TRUE}
library(lubridate)
data$day <- wday(data$date)
data$weekend <- data$day == 1|data$day==7
```

2. Make a panel plot containing a time series plot of the 5-minute interval and the average number of steps taken.

```{r,echo=TRUE}
library(ggplot2)
by_interval <- group_by(data,interval,weekend)
means <- summarize(by_interval,average=mean(steps,na.rm=TRUE))
```



```{r,echo=TRUE}
qplot(data=means,interval,average,geom='line')+facet_grid(weekend~.)+labs(y='Average Steps',title='Average Steps by Interval:Weekday vs. Weekend')
```

**Note: FALSE indicates weekday and TRUE indicates a weekend day.**

So we can see that there is definitely a measureable difference between weekdays and weekend days in terms of which intervals have the most activity.
